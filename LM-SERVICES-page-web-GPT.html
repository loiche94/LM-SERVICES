<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>LM-SERVICES — Électricien à Roses</title>

<meta name="description" content="LM-SERVICES: électricien français basé à Roses (Espagne). 25 ans d'expérience, dépannage et petites installations dans un rayon de 20-30 km." />
<meta name="keywords" content="électricien Roses, dépannage électrique Roses, installation prises Roses, LM-SERVICES" />
<link rel="canonical" href="https://votre-depot-github.github.io/LM-SERVICES/" />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">

<!-- Google analytics placeholder using provided IDs -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-D2CM83J3VT"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-D2CM83J3VT');
gtag('config', 'GT-K5Q634NG');
</script>

<style>
:root{ --bg:#0b0f13; --card:#0f1720; --muted:#9aa4b2; --accent:#ffd166; --accent-2:#4dd6ff; --glass:rgba(255,255,255,0.04); --radius:14px; color-scheme:dark;}
[data-theme="light"]{ --bg:#f6f8fb; --card:#fff; --muted:#58606d; --accent:#ff7a18; --accent-2:#0077cc; --glass:rgba(0,0,0,0.04); color-scheme:light;}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:Inter,system-ui,Arial;color:#e6eef6;background:var(--bg)}
.header{display:flex;align-items:center;gap:14px;padding:18px;max-width:1200px;margin:0 auto}
.logo{width:84px;height:84px;border-radius:12px;overflow:hidden;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center}
.logo img{width:100%;height:100%;object-fit:cover}
.header .info{display:flex;flex-direction:column}
.header .phone{margin-left:auto;font-weight:800;color:var(--accent)}
.container{max-width:1200px;margin:18px auto;padding:18px;display:grid;grid-template-columns:1fr 360px;gap:18px}
@media(max-width:980px){.container{grid-template-columns:1fr;padding:12px}.logo{width:64px;height:64px}}
.hero{background:var(--card);border-radius:14px;padding:18px;position:relative}
.aside{min-width:260px}
.contact-card,.reviews{background:var(--card);padding:14px;border-radius:12px;margin-bottom:12px}
.input,textarea,select{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
.action-btn{background:linear-gradient(90deg,var(--accent),var(--accent-2));border:0;padding:10px 12px;border-radius:10px;color:#071018;font-weight:700;cursor:pointer}
.cookie-banner{position:fixed;left:12px;right:12px;bottom:12px;padding:12px;border-radius:12px;background:var(--card);z-index:80;display:flex;gap:12px;align-items:center}
.lang-switch{display:flex;gap:6px}
.small{font-size:13px;color:var(--muted)}
.map{height:240px;border-radius:12px;overflow:hidden}
.star{cursor:pointer;color:gold;font-size:20px}
.lang-hidden{display:none}
</style>
</head>
<body>

<!-- header -->
<header class="header">
  <div class="logo"><img src="assets/ueRW5izf8xzgxPgqjRPqE.jpeg" alt="LM-SERVICES logo" id="logoImg"></div>
  <div class="info">
    <div style="font-weight:800">LM-SERVICES</div>
    <div class="small" id="tagline">Électricien • Roses • Dépannage & petites installations</div>
  </div>
  <div style="margin-left:auto;display:flex;align-items:center;gap:10px">
    <div class="phone">06 89 49 22 63</div>
    <div class="lang-switch" role="tablist" aria-label="Langues">
      <button data-lang="fr" class="action-btn">FR</button>
      <button data-lang="en" class="action-btn">EN</button>
      <button data-lang="es" class="action-btn">ES</button>
    </div>
  </div>
</header>

<main class="container" role="main">
  <section class="hero" id="mainHero">
    <h1 id="h_title">LM-SERVICES — Rapide, fiable, local</h1>
    <p class="small" id="h_sub">Intervention 20-30 km autour de Roses • Dépannages électriques, petites installations, travaux complémentaires</p>

    <div id="services">
      <!-- Multilingual content filled by script -->
    </div>

    <h3 id="h_why">Pourquoi choisir LM-SERVICES à Roses</h3>
    <ul id="whyList" class="small"></ul>

    <h3 id="h_faq">FAQ</h3>
    <div id="faq" class="small"></div>
  </section>

  <aside class="aside">
    <div class="contact-card" role="region">
      <h3 id="contactTitle">Contact</h3>
      <div class="small">Téléphone: <strong>06 89 49 22 63</strong></div>
      <div class="small">Email: <strong>lm-services02@outlook.fr</strong></div>
      <div style="margin-top:8px;display:flex;gap:8px">
        <a id="whLink" class="action-btn" href="https://wa.me/33689492263" target="_blank" rel="noopener">WhatsApp</a>
        <button id="quoteBtn" class="action-btn">Devis gratuit</button>
      </div>
    </div>

    <div class="reviews">
      <h4 id="reviewsTitle">Avis clients</h4>

      <div id="topReviews" class="small"></div>
      <hr>
      <div id="otherReviews" class="small"></div>

      <h4 id="leaveReview">Laisser un avis</h4>
      <form id="reviewForm" aria-label="Formulaire d'avis">
        <input class="input" id="rName" placeholder="Votre nom" required>
        <textarea class="input" id="rText" rows="3" placeholder="Votre avis" required></textarea>
        <div style="display:flex;justify-content:space-between;align-items:center;margin-top:6px">
          <div id="starWrap">
            <span class="star" data-value="1">☆</span>
            <span class="star" data-value="2">☆</span>
            <span class="star" data-value="3">☆</span>
            <span class="star" data-value="4">☆</span>
            <span class="star" data-value="5">☆</span>
          </div>
          <select id="rLang" class="input" style="max-width:110px">
            <option value="fr">FR</option><option value="en">EN</option><option value="es">ES</option>
          </select>
        </div>
        <div style="margin-top:8px;display:flex;gap:8px">
          <button type="submit" class="action-btn">Envoyer</button>
          <button type="button" id="clearLocal" class="action-btn">Effacer local</button>
        </div>
      </form>
    </div>

    <div class="contact-card small">
      <strong>Zone</strong>
      <div>Roses et alentours 20-30 km</div>
    </div>
  </aside>
</main>

<footer style="max-width:1200px;margin:18px auto;padding:18px;color:var(--muted)">
  <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap">
    <div>
      <strong>LM-SERVICES</strong><div class="small">Loïc — Électricien • Roses</div>
    </div>
    <div style="min-width:300px">
      <div class="map" id="mapWrap">
        <!-- Map will be loaded by script through server endpoint that returns key -->
        <div id="mapPlaceholder" class="small">Chargement carte…</div>
      </div>
    </div>
  </div>
</footer>

<div id="cookieBanner" class="cookie-banner" style="display:none;">
  <div>
    Ce site utilise des cookies essentiels et analytiques anonymes. En cliquant Accepter vous consentez au dépôt de cookies analytiques.
  </div>
  <div style="display:flex;gap:8px">
    <button id="acceptCookies" class="action-btn">Accepter</button>
    <button id="manageCookies" class="action-btn">Gérer</button>
  </div>
</div>

<script>
/* ---------- Multilingual content ---------- */
const content = {
  fr: {
    services:[
      {title:"Urgences & dépannages", txt:"Pannes, disjoncteurs, prises grillées — intervention rapide et sécurisée."},
      {title:"Petites installations", txt:"Prises, interrupteurs, éclairage, garages, box et petites installations."},
      {title:"Travaux complémentaires", txt:"Peinture, jardinage, montages simples — petits chantiers pour dépanner."}
    ],
    why:["25 ans d'expérience dont 5 en Espagne","Réactivité et interventions rapides","Tarifs honnêtes et transparence","Trilingue: Français, English, Español","Zone d'intervention 20-30 km autour de Roses"],
    faq:[
      {q:"Quels travaux refusez-vous ?", a:"Pas d'installation de climatisation ni travaux de plomberie complexes."},
      {q:"Interventions en soirée ?", a:"Oui selon disponibilité et urgence."},
      {q:"Recevez-vous les demandes de devis ?", a:"Oui, via WhatsApp, téléphone ou formulaire; réponse rapide."}
    ],
    labels:{quote:"Devis gratuit",contact:"Contact",reviews:"Avis clients",leave:"Laisser un avis"}
  },
  en: {
    services:[
      {title:"Emergency & Repairs", txt:"Breakdowns, circuit trippers, damaged sockets — fast secure intervention."},
      {title:"Small installations", txt:"Sockets, switches, indoor/outdoor lighting, garage setups."},
      {title:"Additional small tasks", txt:"Painting, gardening, simple furniture assembly — small jobs to help."}
    ],
    why:["25 years experience including 5 in Spain","Fast response times","Fair transparent pricing","Trilingual: Français, English, Español","Service area 20-30 km around Roses"],
    faq:[
      {q:"Which jobs are not done?", a:"No air conditioning installation and no complex plumbing work."},
      {q:"Evening interventions?", a:"Yes, depending on availability and urgency."},
      {q:"How to request a quote?", a:"By phone, WhatsApp or the review/contact form."}
    ],
    labels:{quote:"Free quote",contact:"Contact",reviews:"Customer reviews",leave:"Leave a review"}
  },
  es: {
    services:[
      {title:"Urgencias y reparaciones", txt:"Averías, interruptores, enchufes quemados — intervención rápida y segura."},
      {title:"Pequeñas instalaciones", txt:"Enchufes, interruptores, iluminación interior/exterior, garajes."},
      {title:"Tareas complementarias", txt:"Pintura, jardinería, montajes simples — pequeños trabajos para ayudar."}
    ],
    why:["25 años de experiencia, 5 en España","Respuesta rápida","Precios honestos y transparentes","Trilingüe: Français, English, Español","Zona 20-30 km alrededor de Roses"],
    faq:[
      {q:"Qué trabajos no realiza?", a:"No instalamos climatización ni trabajos de fontanería complejos."},
      {q:"Intervenciones por la tarde?", a:"Sí, según disponibilidad y urgencia."},
      {q:"Cómo pedir presupuesto?", a:"Por teléfono, WhatsApp o formulario de contacto."}
    ],
    labels:{quote:"Presupuesto gratis",contact:"Contacto",reviews:"Opiniones",leave:"Dejar una opinión"}
  }
};

let lang = localStorage.getItem('lm_lang') || 'fr';
function renderLang(){
  const L = content[lang];
  document.getElementById('services').innerHTML = '<div style="display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:12px">' +
    L.services.map(s=>`<div style="background:rgba(255,255,255,0.02);padding:10px;border-radius:10px"><strong>${s.title}</strong><div class="small">${s.txt}</div></div>`).join('') +
    '</div>';
  const whyList = document.getElementById('whyList');
  whyList.innerHTML = L.why.map(i=>`<li>${i}</li>`).join('');
  document.getElementById('h_title').textContent = lang==='fr' ? 'LM-SERVICES — Rapide, fiable, local' : lang==='en' ? 'LM-SERVICES — Fast, Reliable, Local' : 'LM-SERVICES — Rápido, fiable, local';
  document.querySelectorAll('.action-btn').forEach(b=>{ if(b.dataset.lang) b.style.outline = b.dataset.lang===lang ? '3px solid rgba(255,255,255,0.08)' : ''; });
  // locale FAQ
  document.getElementById('faq').innerHTML = content[lang].faq.map(f=>`<strong>${f.q}</strong><div>${f.a}</div><br>`).join('');
  localStorage.setItem('lm_lang', lang);
}
document.querySelectorAll('[data-lang]').forEach(btn=>{
  btn.addEventListener('click', ()=> { lang = btn.dataset.lang; renderLang(); });
});
renderLang();

/* ---------- Reviews initial data and UI ---------- */
const initialReviews = [
  {name:"Melodie Pascual", text:"Un IMMENSE MERCI à Mr Mendes, d'avoir répondu à notre appel ce jeudi soir.", stars:5, date:"04/01/2024"},
  {name:"Jennifer Coulée", text:"Panne d'électricité en ce jour de Noël, le patron est venu me dépanner.", stars:5, date:"25/12/2022"},
  {name:"Jean-Claude Riviere", text:"Électricien professionnel pour Empuriabrava.", stars:5, date:"07/02/2023"}
];

function showTopReviews(){
  const el = document.getElementById('topReviews');
  el.innerHTML = initialReviews.map(r=>`<div style="margin-bottom:8px"><strong>${r.name}</strong><div class="small">${'★'.repeat(r.stars)} ${r.text}</div></div>`).join('');
}
showTopReviews();
function loadOtherReviews(){
  const el = document.getElementById('otherReviews');
  const rest = [
    "Beyemeglaurence Garrigues — Super service sur Llança pour un pb de prises grillées!",
    "Ornella Ornella — Top !!! se déplace direct et très bon travail à prix correct"
  ];
  el.innerHTML = rest.map(r=>`<div style="margin-bottom:6px">${r}</div>`).join('');
}
loadOtherReviews();

/* ---------- Stars handling ---------- */
const stars = document.querySelectorAll('.star');
let rating = 5;
stars.forEach(s=>{
  s.addEventListener('click', ()=> {
    rating = Number(s.dataset.value);
    stars.forEach(x=> x.textContent = Number(x.dataset.value) <= rating ? '★' : '☆');
  });
});
stars.forEach(x=> x.textContent='★'); // default

/* ---------- Review submission to server endpoint ---------- */
/* Endpoints to adjust before deploy */
const SUBMIT_REVIEW_ENDPOINT = '/.netlify/functions/submit-review'; // replace if azure/php is used
const GET_MAP_KEY_ENDPOINT = '/.netlify/functions/get-map-key'; // endpoint that returns Google Maps key from env

document.getElementById('reviewForm').addEventListener('submit', async (e)=>{
  e.preventDefault();
  const name = document.getElementById('rName').value.trim() || 'Anonyme';
  const text = document.getElementById('rText').value.trim();
  const langSel = document.getElementById('rLang').value;
  if(!text) { alert(lang==='fr' ? 'Veuillez écrire votre avis.' : lang==='en' ? 'Please write your review.' : 'Por favor escriba su opinión.'); return; }

  const payload = { name, text, stars: rating, lang: langSel, source: 'site' };
  try{
    const res = await fetch(SUBMIT_REVIEW_ENDPOINT, {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify(payload)
    });
    if(res.ok){
      alert(lang==='fr' ? 'Merci, votre avis a été envoyé.' : lang==='en' ? 'Thanks, your review was sent.' : 'Gracias, su opinión ha sido enviada.');
      // optionally append locally for preview
      const other = document.getElementById('otherReviews');
      other.insertAdjacentHTML('afterbegin', `<div><strong>${name}</strong> — ${'★'.repeat(rating)} ${text}</div>`);
      document.getElementById('reviewForm').reset();
    } else {
      const txt = await res.text();
      console.error('Review submit error', txt);
      alert('Erreur envoi avis');
    }
  } catch(err){
    console.error(err);
    alert('Erreur réseau ou endpoint non configuré.');
  }
});

/* ---------- Map loading via server-provided key ---------- */
async function initMap(){
  try{
    const r = await fetch(GET_MAP_KEY_ENDPOINT);
    if(!r.ok) { document.getElementById('mapPlaceholder').textContent = 'Carte indisponible'; return; }
    const data = await r.json();
    const key = data.key;
    if(!key){ document.getElementById('mapPlaceholder').textContent = 'Clé manquante'; return; }
    const s = document.createElement('script');
    s.src = `https://maps.googleapis.com/maps/api/js?key=${encodeURIComponent(key)}&callback=onMapReady`;
    s.async = true; s.defer = true;
    document.head.appendChild(s);
    window.onMapReady = function(){
      const map = new google.maps.Map(document.getElementById('mapWrap'), {
        center:{lat:42.2833, lng:3.2033}, zoom:12
      });
      new google.maps.Marker({position:{lat:42.2833, lng:3.2033}, map, title:'LM-SERVICES Roses'});
    };
  } catch(e){
    console.error(e);
    document.getElementById('mapPlaceholder').textContent = 'Erreur chargement carte';
  }
}
initMap();

/* ---------- Cookie banner RGPD ----------
   - stocke le consentement dans localStorage
   - bloque le chargement de scripts analytiques si non accepté (ici simple placeholder)
*/
const cookieBanner = document.getElementById('cookieBanner');
if(!localStorage.getItem('lm_cookies_accepted')) cookieBanner.style.display='flex';
document.getElementById('acceptCookies').addEventListener('click', ()=>{
  localStorage.setItem('lm_cookies_accepted','1');
  cookieBanner.style.display='none';
  // here you would trigger analytics init if required
});

/* ---------- Quote button ---------- */
document.getElementById('quoteBtn').addEventListener('click', ()=> {
  window.location.href = 'mailto:lm-services02@outlook.fr?subject=Demande%20de%20devis%20LM-SERVICES';
});

/* ---------- Accessibility and small helpers ---------- */
document.getElementById('clearLocal').addEventListener('click', ()=> {
  if(confirm('Supprimer les aperçus locaux des avis ?')) document.getElementById('otherReviews').innerHTML='';
});
</script>
</body>
</html>
